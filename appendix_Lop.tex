% !TeX root = main.tex
\chapter{Properties of the L Operator}\label{app:properties-L-op}
In this chapter, we explore additional properties of the $\Lop$ operator, which is defined in \cref{def:Loperator}. First, we demonstrate that the $\Lop$ operator shares all the properties of derivatives. Let $G$ be an $m$-dimensional matrix Lie group and $\mathbf{X}\in G$ be a point in the group. Let $\SL:\mathbb{R}^m\to\mathfrak{g}$ be an isomorphism between $m$-dimensional vectors and the Lie algebra $\mathfrak{g}$ of $G$. For some function $f:G\to \mathbb{R}$, the $\Lop$ operator can be expressed as
\begin{align}
    \Lop[f](\mathbf{X})\boldsymbol{\zeta} = \frac{d}{d\varepsilon}\biggl(f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}\,\forall\,\boldsymbol{\zeta}\in\mathbb{R}^m. \label{eq:appendix-prop-Lop-definition-L}
\end{align}
\section{Linearity}
The $\Lop$ operator is linear. Specifically, for any functions $f,g:G\to \mathbb{R}$ and scalars $a,b\in\mathbb{R}$, we have
\begin{align}
    \begin{split}
        \Lop[a f + b g](\mathbf{X})\boldsymbol{\zeta} &= \frac{d}{d\varepsilon}\biggl(a f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr) + b g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}\\
        &= \frac{d}{d\varepsilon}\biggl(a f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0} +  \frac{d}{d\varepsilon}\biggl(b g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}\\
        &= a \Lop[f](\mathbf{X})\boldsymbol{\zeta} + b \Lop[g](\mathbf{X})\boldsymbol{\zeta}\\
        &= \bigl(a \Lop[f](\mathbf{X}) + b \Lop[g](\mathbf{X})\bigr)\boldsymbol{\zeta},
    \end{split}
\end{align}
which shows that $\Lop[a f + b g] = a \Lop[f] + b \Lop[g]$, which confirms that the $\Lop$ operator is linear.
\section{Product and quotient rule}\label{sec:appendix-prop-Lop-product-quotient}
The $\Lop$ operator satisfies both the product and quotient rules. Let $f,g:G\to \mathbb{R}$ be scalar functions. By definition, we have
\begin{align}
  \begin{split}
      \Lop[fg](\mathbf{X})\boldsymbol{\zeta} =&
      \frac{d}{d\varepsilon}\biggl(f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}\\
      =& \frac{d}{d\varepsilon}\biggl(f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\Bigr|_{\varepsilon=0}
      \\ &+ f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\Bigr|_{\varepsilon=0}\frac{d}{d\varepsilon}\biggl(g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}
      \\
      =& \frac{d}{d\varepsilon}\biggl(f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}g(\mathbf{X})
      + f(\mathbf{X})\biggl(g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}\\
      =& \Lop[f](\mathbf{X})\boldsymbol{\zeta}g(\mathbf{X}) + f(\mathbf{X})\Lop[g](\mathbf{X})\boldsymbol{\zeta}\\
        =& \bigl(\Lop[f](\mathbf{X})g(\mathbf{X}) + f(\mathbf{X})\Lop[g](\mathbf{X})\bigr)\boldsymbol{\zeta},
  \end{split}
\end{align}
since $f$ and $g$ are scalar functions. This shows that $\Lop[fg] = \Lop[f]g + f\Lop[g]$. Next, we demonstrate the quotient rule. For that, it suffices to show that $\Lop[1/g] = -\Lop[g]/g^2$. In this case, we have
\begin{align}
    \begin{split}
        \Lop\biggl[\frac{1}{g}\biggr](\mathbf{X})\boldsymbol{\zeta} =& \left.\frac{d}{d\varepsilon}\left(\frac{1}{g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)}\right)\right|_{\varepsilon=0}\\
        =& -\frac{{\displaystyle\frac{d}{d\varepsilon}}\biggl(g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}}{\biggl(g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}}\\
        =& -\frac{\Lop[g]}{g(\mathbf{X})^2}\boldsymbol{\zeta},
    \end{split}
\end{align}
which implies
\begin{align}
    \Lop\biggl[\frac{f}{g}\biggr] = \Lop[f]\frac{1}{g} - f\frac{\Lop[g]}{g^2} = \frac{\Lop[f]g - f\Lop[g]}{g^2}.
\end{align}
Thus, the $\Lop$ operator satisfies the quotient rule.
\section{Chain rules}
A chain rule has already been shown in \cref{lemma:chainrule}, which applies to expressions of the form $\frac{d}{d\sigma}f\bigl(\mathbf{X}(\sigma)\bigr)$. In this section, we present \vtwo{two additional chain rules. The first pertains to the $\Lop$ operator applied to function composition, while the second concerns the partial $\Lop_\mathbf{V}$ operator for left-invariant functions.}

\vtwo{Let $f:\mathbb{R}\to\mathbb{R}$ and $g:G\to \mathbb{R}$ be functions, and $\mathbf{X}$ be a point in $G$. The chain rule for the $\Lop$ operator of function composition is given by:
\begin{align}
    \Lop\Bigl[f\bigl(g(\mathbf{X})\bigr)\Bigr](\mathbf{X})\boldsymbol{\zeta} &= \frac{d}{d\varepsilon}\Biggl(f\biggl(g\Bigl(\exp\bigl(\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\Biggr)\Biggr|_{\varepsilon=0}\\
    &= \frac{df}{dg}\bigl(g(\mathbf{X})\bigr)\biggl(\frac{d}{d\varepsilon}g\Bigl(\exp\bigl(\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}\\
    &= \frac{df}{dg}\bigl(g(\mathbf{X})\bigr)\Lop[g](\mathbf{X})\boldsymbol{\zeta},
\end{align}
which implies
\begin{align}
    \Lop\Bigl[f\bigl(g(\mathbf{X})\bigr)\Bigr](\mathbf{X}) = \frac{df}{dg}\bigl(g(\mathbf{X})\bigr)\Lop[g](\mathbf{X}).
\end{align}
}

\vtwo{We now derive a chain rule specifically related to the} $\Lop_\mathbf{V}$ operator for left-invariant functions. Let $\mathbf{X},\mathbf{Y}\in G$, and $f : G \times G \to \mathbb{R}$ be a left-invariant function. Define $\mathbf{Z} = \mathbf{Y}^{-1}\mathbf{X}$, so that $f(\mathbf{X},\mathbf{Y}) = g(\mathbf{Z})$ for some $g:G\to\mathbb{R}$. Our goal is to determine the $\Lop$ operator of $g$ with respect to $\mathbf{X}$. 

First, consider a variation of $\mathbf{X}$ using the right-hand side of \eqref{eq:appendix-prop-Lop-definition-L} for $g$:
\begin{align}
    \frac{d}{d\varepsilon}\biggl(g\Bigl(\mathbf{Y}^{-1}\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0} &= \frac{d}{d\varepsilon}\biggl(g\Bigl(\mathbf{Y}^{-1}\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{Y}\mathbf{Y}^{-1}\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}\\
    &= \frac{d}{d\varepsilon}\biggl(g\Bigl(\exp\bigl(\varepsilon\mathbf{Y}^{-1}\SL[\boldsymbol{\zeta}]\mathbf{Y}\bigr)\mathbf{Y}^{-1}\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0} \\
    &= \frac{d}{d\varepsilon}\biggl(g\Bigl(\exp\bigl(\varepsilon\mathcal{S}'(\boldsymbol{\zeta})\bigr)\mathbf{Y}^{-1}\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0},
\end{align}
where $\mathcal{S}'(\boldsymbol{\zeta}) = \mathbf{Y}^{-1}\SL[\boldsymbol{\zeta}]\mathbf{Y}$. Since $\mathbf{Y}^{-1}\SL[\boldsymbol{\zeta}]\mathbf{Y}$ lies in $\mathfrak{g}$, there exists a vector $\boldsymbol{\zeta}'$ such that $\SL[\boldsymbol{\zeta}'] = \mathbf{Y}^{-1}\SL[\boldsymbol{\zeta}]\mathbf{Y}$. This implies that $\boldsymbol{\zeta}'$ is a function of $\boldsymbol{\zeta}$ and $\mathbf{Y}$, i.e., $\boldsymbol{\zeta}' \triangleq \boldsymbol{\zeta}'(\boldsymbol{\zeta}, \mathbf{Y})$. Therefore, we can write
\begin{align}
    \frac{d}{d\varepsilon}\biggl(g\Bigl(\mathbf{Y}^{-1}\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0} &= \frac{d}{d\varepsilon}\biggl(g\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}']\bigr)\mathbf{Y}^{-1}\mathbf{X}\Bigr)\biggr)\biggr|_{\varepsilon=0}\\
    &= \Lop[g](\mathbf{Z})\boldsymbol{\zeta}'(\boldsymbol{\zeta}, \mathbf{Y}) \label{appendix-prop-Lop-chain-rule-LgZ-zeta-prime},
\end{align}
by definition. Now, since $f$ is left-invariant, we can express
\begin{align}
    \Lop_\mathbf{V}[f](\mathbf{X}, \mathbf{Y})\boldsymbol{\zeta} &= 
    \Lop_\mathbf{V}[f](\mathbf{Y}^{-1}\mathbf{X}, \mathbf{I})\boldsymbol{\zeta}
    = \frac{d}{d\varepsilon}\biggl(f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{Y}^{-1}\mathbf{X}, \mathbf{I}\Bigr)\biggr)\biggr|_{\varepsilon=0},
\end{align}
which leads to
\begin{align}
    \Lop_\mathbf{V}[f](\mathbf{X}, \mathbf{Y})\boldsymbol{\zeta} = \Lop[g](\mathbf{Z})\boldsymbol{\zeta}'(\boldsymbol{\zeta}, \mathbf{Y}) \label{app:prop-Lop-chain-rule-LVf-final-form},
\end{align}
which is the expression for the chain rule in the context of left-invariant functions. \vtwo{Clearly, $\boldsymbol{\zeta}'$ is expressed as:
\begin{align}
    \boldsymbol{\zeta}'(\boldsymbol{\zeta}, \mathbf{Y}) &= \invSL[\mathbf{Y}^{-1}\SL[\boldsymbol{\zeta}]\mathbf{Y}]\\
    &= \invSL[\sum_{i=1}^m\mathbf{Y}^{-1}\SL[\mathbf{e}_i]\mathbf{Y}\zeta_i]\\
    &= \sum_{i=1}^m\invSL[\mathbf{Y}^{-1}\SL[\mathbf{e}_i]\mathbf{Y}]\zeta_i\\
    &= \begin{bmatrix}
        \invSL[\mathbf{Y}^{-1}\SL[\mathbf{e}_1]\mathbf{Y}] & \cdots & \invSL[\mathbf{Y}^{-1}\SL[\mathbf{e}_m]\mathbf{Y}]
    \end{bmatrix} \boldsymbol{\zeta}\\
    &= \mathcal{Z}(\mathbf{Y})\boldsymbol{\zeta},
\end{align}
where the linearity properties of $\SL$ and $\invSL$ have been used. This implies that the chain rule for the $\Lop_\mathbf{V}$ operator can be expressed as:
\begin{align}
    \Lop_\mathbf{V}[f](\mathbf{X}, \mathbf{Y})\boldsymbol{\zeta} = \Lop[g](\mathbf{Z})\mathcal{Z}(\mathbf{Y})\boldsymbol{\zeta}. \label{app:prop-Lop-chain-rule-LVf-final-form-matrix}
\end{align}
}
\subsection{The case for SE(3)}\label{app:prop-Lop-chain-rule-SE3}
In the case of $\text{SE}(3)$, we can show that $\boldsymbol{\zeta}'(\boldsymbol{\zeta}, \mathbf{Y})$ is given by a \vtwo{simple} matrix multiplication. Let $\SL:\mathbb{R}^6\to\mathfrak{se}(3)$ be the canonical isomorphism between $\mathbb{R}^6$ and $\mathfrak{se}(3)$, so that $\mathbf{Y}$ can be written as
\begin{align}
    \mathbf{Y} = \begin{bmatrix}
        \mathbf{R}_y & \mathbf{p}_y\\
        \mathbf{0} & 1
    \end{bmatrix},\,\mathbf{R}_y\in\text{SO}(3), \mathbf{p}_y\in\mathbb{R}^3.
\end{align}

Next, define $\widehat{\mathcal{S}}:\mathbb{R}^3\to\mathfrak{so}(3)$ as the canonical isomorphism between $\mathbb{R}^3$ and $\mathfrak{so}(3)$, and let $\boldsymbol{\zeta}=[\mathbf{v}^\top\ \boldsymbol{\omega}^\top]^\top$, where $\mathbf{v}, \boldsymbol{\omega}\in\mathbb{R}^3$. Then, we have the following expression:
\begin{align}
  \begin{split}
      \mathbf{Y}^{-1}\SL[\boldsymbol{\zeta}]\mathbf{Y} &= 
      \begin{bmatrix}
          \mathbf{R}_y^\top & -\mathbf{R}_y^\top\mathbf{p}_y\\
          \mathbf{0} & 1
      \end{bmatrix}
      \begin{bmatrix}
          \widehat{\mathcal{S}}(\boldsymbol{\omega}) & \mathbf{v}\\
          \mathbf{0} & 0
      \end{bmatrix}
      \begin{bmatrix}
          \mathbf{R}_y & \mathbf{p}_y\\
          \mathbf{0} & 1
      \end{bmatrix}\\
      &= 
      \begin{bmatrix}
          \mathbf{R}_y^\top\widehat{\mathcal{S}}(\boldsymbol{\omega})\mathbf{R}_y & \mathbf{R}_y^\top\widehat{\mathcal{S}}(\boldsymbol{\omega})\mathbf{p}_y + \mathbf{R}_y^\top\mathbf{v}\\
          \mathbf{0} & 0
      \end{bmatrix}\\
      &= \SL[\boldsymbol{\zeta}'].
  \end{split}
\end{align}
Using the properties of $\widehat{\mathcal{S}}$, we have $\mathbf{R}_y^\top\widehat{\mathcal{S}}(\boldsymbol{\omega})\mathbf{R}_y = \widehat{S}(\mathbf{R}_y^\top\boldsymbol{\omega})$, thus we can express $\boldsymbol{\zeta}'$ as
\begin{align}
    \boldsymbol{\zeta}'(\boldsymbol{\zeta}, \mathbf{Y}) = \begin{bmatrix}
        \mathbf{R}_y^\top\widehat{\mathcal{S}}(\boldsymbol{\omega})\mathbf{p}_y + \mathbf{R}_y^\top\mathbf{v}\\
        \mathbf{R}_y^\top\boldsymbol{\omega}
    \end{bmatrix}.
\end{align}

Note that $\widehat{\mathcal{S}}(\boldsymbol{\omega})\mathbf{p}_y = -\widehat{\mathcal{S}}(\mathbf{p}_y)\boldsymbol{\omega}$, so the following holds
\begin{align}
    \boldsymbol{\zeta}'(\boldsymbol{\zeta}, \mathbf{Y}) = \begin{bmatrix}
        \mathbf{R}_y^\top & -\mathbf{R}_y^\top\widehat{\mathcal{S}}(\mathbf{p}_y)\\
        \mathbf{0} & \mathbf{R}_y^\top
    \end{bmatrix}\begin{bmatrix}
        \mathbf{v}\\ \boldsymbol{\omega}
    \end{bmatrix}
    = \mathcal{Z}(\mathbf{Y})\boldsymbol{\zeta}.
\end{align}
\vtwo{Thus, achieving the expression \eqref{app:prop-Lop-chain-rule-LVf-final-form-matrix}}:
\begin{align}
    \Lop_\mathbf{V}[f](\mathbf{X}, \mathbf{Y}) = \Lop[g](\mathbf{Z})\mathcal{Z}(\mathbf{Y}). \label{eq:appendix-prop-Lop-chain-rule-SE3}
\end{align}

\section{Relationship with the Lie derivative}
\vtwo{Lie derivatives are directional derivatives adapted to the structure of a manifold. While standard directional derivatives rely on the properties of Euclidean space and are thus only locally valid for manifolds, Lie derivatives are defined in a way that ensures their validity globally on the manifold. Although the $\Lop$ operator pertains to functions, we begin by recalling the definition of the Lie derivative for vector fields for the sake of completeness.}

\vtwo{In the context of vector fields, the Lie derivative provides a measure of the change of one vector field along the flow generated by another. Let $G$ be a Lie group, and let $V\in T_\mathbf{X}G$ and $W\in T_\mathbf{Y}G$ be vector fields on $G$. Since these vector fields belong to different tangent spaces, it is necessary to transport points using the flow. Let $\rho:\mathbb{R}\times G$ be the flow of $V$. Following the integral curve of $\rho$ with initial condition $\mathbf{X}$, we can evaluate $W(\rho(\sigma, \mathbf{X}))$, which lies in the tangent space of $G$ at $\rho(\sigma, \mathbf{X})$. To compare both vector fields, it is necessary to transport $W\bigl(\rho(\sigma, \mathbf{X})\bigr)$ back to $T_\mathbf{X}G$. The Lie derivative of $W$ with respect to $V$, denoted by $\mathscr{L}_V W$, at $\mathbf{X}$ is defined as follows \citep[p. 316]{Gallier2020}:
\begin{align}
    (\mathscr{L}_V W)_\mathbf{X}=\frac{d}{d\sigma}\bigl(d(\rho(-\sigma, \mathbf{X}))_{\rho(\sigma, \mathbf{X})}\bigr)\bigl(W(\rho(\sigma, \mathbf{X}))\bigr)\bigr|_{\sigma=0}.
\end{align}
This operation is often expressed more concisely using the \emph{pull-back} of $W$ by $\rho$, denoted $\rho(\sigma, \mathbf{X})^*W$, leading to the simplified expression \citep[p. 317]{Gallier2020}
\begin{align}
    (\mathscr{L}_V W)_\mathbf{X} = \frac{d}{d\sigma}\bigl(\rho(\sigma, \mathbf{X})^*W\bigr)\bigr|_{\sigma=0}.
\end{align}}

\vtwo{The Lie derivative of a function $f:G\to \mathbb{R}$ at a point $\mathbf{X}\in G$ with respect to a vector field $V$ with flow $\rho$ is expressed as \citep[p. 121]{Lang2012}:
\begin{align}
    (\mathscr{L}_V f)_\mathbf{X} = \lim_{\sigma \to 0 }\frac{f\bigl(\rho(\sigma, \mathbf{X})\bigr) - f(\mathbf{X})}{\sigma} = \frac{d}{d\sigma}\Bigl(f\bigl(\rho(\sigma, \mathbf{X})\bigr)\Bigr)\Bigr|_{\sigma=0}.
\end{align}}

\vtwo{For a matrix Lie group $G$, let $\mathbf{G}(\sigma)$ be a curve in $G$ with tangent vector $V$ at $\mathbf{G}(\sigma)$. The curve derivative is then given by
\begin{align}
    \frac{d}{d\sigma}\mathbf{G}(\sigma) = V(\mathbf{G}(\sigma)),
\end{align}
which, as shown in \cref{lemma:very-important-fact}, can be expressed as
\begin{align}
    \frac{d}{d\sigma}\mathbf{G}(\sigma) = \SL\bigl(\boldsymbol{\xi}(\sigma)\bigr)\mathbf{G}(\sigma),
\end{align}
for some isomorphism $\SL:\mathbb{R}^m\to \mathfrak{g}$ and function $\boldsymbol{\xi}:\mathbb{R}\to\mathbb{R}^m$.}

\vtwo{Let $\mathbf{G} = \mathbf{G}(\sigma)$ for some fixed $\sigma$. A local flow $\rho(\varepsilon, \mathbf{G})$ of $V$ can be expressed as $\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{G}$ for small $\varepsilon$ and some vector $\boldsymbol{\zeta}\in\mathbb{R}^m$. The Lie derivative of $f$ with respect to $V$ at $\mathbf{G}$ is therefore
\begin{align}
    (\mathscr{L}_V f)_{\mathbf{G}} = \lim_{\varepsilon \to 0 }\frac{f\Bigl(\exp\bigl(\varepsilon\SL[\boldsymbol{\zeta}]\bigr)\mathbf{G}\Bigr) - f(\mathbf{G})}{\varepsilon},
\end{align}
which, by definition, is exactly equal to $\Lop[f](\mathbf{G})\boldsymbol{\zeta}$, demonstrating that the $\Lop$ operator represents a component of the Lie derivative.}